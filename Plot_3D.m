close all; clear;
addpath('npy-matlab-master');

% Read 3D npy file, generated by recon3d.py
A = readNPY('/u/data/alcer/DFXRM_rec/Rec_test/grain_ang_1.npy');
A_final = zeros(size(A,1), size(A,2), size(A,3));

for cc = 1:size(A,3)
    A_final(:,:,cc) = A(:, :, cc,1);
    for aa = 1:size(A,1)
        for bb = 1:size(A,2)
            if A_final(aa,bb,cc)/mean(mean(A(:,:,cc,1))) < 1.05 
                A_final(aa,bb,cc) = 0;
            else
                A_final(aa,bb,cc) = A(aa, bb, cc,1);%-(1.05*mean(mean(A(:,:,cc,1))));
            end
        end
    end
end

output_w = sprintf('weight_3D.vtk');
savevtk(A_final, output_w);

